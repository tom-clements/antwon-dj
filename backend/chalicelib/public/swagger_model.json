{
    "swagger": "2.0",
    "info": {
        "version": "1.0",
        "title": "backend"
    },
    "schemes": [
        "http"
    ],
    "paths": {
        "/login": {
            "get": {
                "summary": "Login Users",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "responses": {
                    "302": {
                        "description": "302 response",
                        "headers": {
                            "url": {
                                "type": "string",
                                "description": "Redirect to Antwon Cognito Auth login page"
                            }
                        }
                    }
                }
            }
        },
        "/login/callback": {
            "get": {
                "summary": "Callback from authenticating with Cognito",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "responses": {
                    "302": {
                        "description": "302 response",
                        "headers": {
                            "url": {
                                "type": "string",
                                "description": "Redirect to Antwon client home page"
                            },
                            "Set-Cookie": {
                                "type": "string",
                                "description": "Sets the refresh token as a cookie with key: refresh-token"
                            }
                        }
                    }
                }
            }
        },
        "/user/token": {
            "post": {
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "in":  "body",
                        "name":  "body",
                        "description": "Refresh Token",
                        "required":  true,
                        "schema": {
                            "$ref": "#/definitions/RefreshToken"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "200 response",
                        "schema": {
                            "$ref": "#/definitions/Tokens"
                        }
                    },
                    "400": {
                        "description": "Input Validation Error"
                    }
                },
                "summary": "Retrieve User Tokens from refresh token",
                "description": "Provide a refresh token stored as a cookie on the client and use to retrieve access tokens"
            }
        },
        "/user/info": {
            "get": {
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "security": [
                    {
                        "antwon_user_pool": [
                            "email",
                            "openid",
                            "profile"
                        ]
                    }
                ],
                "responses": {
                    "200": {
                        "description": "200 response",
                        "schema": {
                            "$ref": "#/definitions/Tokens"
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "400": {
                        "description": "Input Validation Error"
                    }
                },
                "summary": "Retrieve User Information about current user",
                "description": "Provides all user information, including name and email"
            }
        },
        "/user/spotify/connect": {
            "get": {
                "summary": "Link Spotify to Users' accounts",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "security": [
                    {
                        "antwon_user_pool": [
                            "email",
                            "openid",
                            "profile"
                        ]
                    }
                ],
                "responses": {
                    "302": {
                        "description": "302 response",
                        "headers": {
                            "url": {
                                "type": "string",
                                "description": "Redirect to Spotify OAuth2 page"
                            }
                        }
                    }
                }
            }
        },
        "/user/spotify/callback": {
            "get": {
                "summary": "Callback after authenticating with Spotify OAuth2",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "responses": {
                    "302": {
                        "description": "302 response",
                        "headers": {
                            "url": {
                                "type": "string",
                                "description": "Redirect to Antwon client home page"
                            },
                            "Set-Cookie": {
                                "type": "string",
                                "description": "Sets the refresh token as a cookie with key: refresh-token"
                            }
                        }
                    }
                }
            }
        },
        "/user/spotify/playlist": {
            "get": {
                "summary": "Retrieve the user playlist",
                "description": "Not Implemented",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "responses": {
                    "200": {
                        "description": "200 response"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Insufficient Permissions"
                    }
                }
            }
        },
        "/user/spotify/playlist/{playlist_id}": {
            "get": {
                "summary": "Retrieve tracks from user playlist",
                "description": "Not Implemented",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "responses": {
                    "200": {
                        "description": "200 response"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Insufficient Permissions"
                    },
                    "404": {
                        "description": "Playlist Not Found"
                    }
                },
                "parameters": [
                    {
                        "name": "playlist_id",
                        "in": "path",
                        "required": true,
                        "type": "string"
                    }
                ]
            }
        },
        "/code/{room_code}": {
            "get": {
                "summary": "Retrieve Room GUID from room code",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "responses": {
                    "200": {
                        "description": "200 response",
                        "schema": {
                            "$ref": "#/definitions/RoomGuid"
                        }
                    },
                    "404": {
                        "description": "Room Not Found"
                    }
                },
                "parameters": [
                    {
                        "name": "room_code",
                        "in": "path",
                        "required": true,
                        "type": "string"
                    }
                ]
            }
        },
        "/room": {
            "post": {
                "summary": "Create a room",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "in": "body",
                        "name": "body",
                        "description": "Room object to be added",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/Room"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "200 response"
                    },
                    "400": {
                        "description": "Input Validation Error"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Insufficient Permissions"
                    },
                    "404": {
                        "description": "Room Not Found"
                    },
                    "409": {
                        "description": "Room Already Exists"
                    }
                },
                "security": [
                    {
                        "antwon_user_pool": [
                            "email",
                            "openid",
                            "profile"
                        ]
                    }
                ]
            }
        },
        "/room/{room_guid}": {
            "get": {
                "summary": "Retrieve Room Info",
                "description": "Not Implemented",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "responses": {
                    "200": {
                        "description": "200 response"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Insufficient Permissions"
                    },
                    "404": {
                        "description": "Room Not Found"
                    }
                },
                "security": [
                    {
                        "antwon_user_pool": [
                            "email",
                            "openid",
                            "profile"
                        ]
                    }
                ],
                "parameters": [
                    {
                        "name": "room_guid",
                        "in": "path",
                        "required": true,
                        "type": "string"
                    }
                ]
            },
            "delete": {
                "summary": "Delete a Room",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "responses": {
                    "200": {
                        "description": "200 response"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Insufficient Permissions"
                    },
                    "404": {
                        "description": "Room Not Found"
                    }
                },
                "security": [
                    {
                        "antwon_user_pool": [
                            "email",
                            "openid",
                            "profile"
                        ]
                    }
                ],
                "parameters": [
                    {
                        "name": "room_guid",
                        "in": "path",
                        "required": true,
                        "type": "string"
                    }
                ]
            }
        },
        "/room/{room_guid}/queue": {
            "get": {
                "summary": "Retrieve the room queue",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "responses": {
                    "200": {
                        "description": "200 response",
                        "schema": {
                            "$ref": "#/definitions/RoomQueue"
                        }
                    },
                    "404": {
                        "description": "Room Not Found"
                    }
                },
                "parameters": [
                    {
                        "name": "room_guid",
                        "in": "path",
                        "required": true,
                        "type": "string"
                    }
                ]
            },
            "post": {
                "summary": "Add a song to the room queue",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "responses": {
                    "200": {
                        "description": "200 response"
                    },
                    "400": {
                        "description": "Input Validation Error"
                    },
                    "404":{
                        "description": "Room not Found"
                    }
                },
               "parameters": [
                    {
                        "name": "room_guid",
                        "in": "path",
                        "required": true,
                        "type": "string"
                    },
                   {
                        "in": "body",
                        "name": "body",
                        "description": "Song object to be added",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/Song"
                        }
                    }
                ]
            }
        },
        "/room/{room_guid}/search": {
            "get": {
                "summary": "Search songs using query",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "responses": {
                    "200": {
                        "description": "200 response",
                        "schema": {
                            "$ref": "#/definitions/SearchSong"
                        }
                    },
                    "400": {
                        "description": "Input Validation Error"
                    },
                    "404": {
                        "description": "Room Not Found"
                    }
                },
                "parameters": [
                    {
                        "name": "room_guid",
                        "in": "path",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "name": "query",
                        "required": true,
                        "type": "string"
                    }
                ]
            }
        },
        "/room/{room_guid}/playing": {
            "get": {
                "summary": "Retrieve current playing song in room",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "responses": {
                    "200": {
                        "description": "200 response",
                        "schema": {
                            "$ref": "#/definitions/Song"
                        }
                    },
                    "404": {
                        "description": "Room Not Found"
                    }
                },
                "parameters": [
                    {
                        "name": "room_guid",
                        "in": "path",
                        "required": true,
                        "type": "string"
                    }
                ]
            }
        },
        "/room/{room_guid}/queue/like": {
            "post": {
                "summary": "Add like to room song",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "responses": {
                    "200": {
                        "description": "200 response"
                    },
                    "400": {
                        "description": "Input Validation Error"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "404": {
                        "description": "Like Not Found"
                    },
                    "409": {
                        "description": "Like Already Exists"
                    }
                },
                "security": [
                    {
                        "antwon_user_pool": [
                            "email",
                            "openid",
                            "profile"
                        ]
                    }
                ],
                "parameters": [
                    {
                        "name": "room_guid",
                        "in": "path",
                        "required": true,
                        "type": "string"
                    },
                   {
                        "in": "body",
                        "name": "body",
                        "description": "Room Song to add like to",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/RoomSong"
                        }
                    }
                ]
            },
            "delete": {
                "summary": "Remove like from room song",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "responses": {
                    "200": {
                        "description": "200 response"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "404": {
                        "description": "Like Not Found"
                    }
                },
                "security": [
                    {
                        "antwon_user_pool": [
                            "email",
                            "openid",
                            "profile"
                        ]
                    }
                ],
                "parameters": [
                    {
                        "name": "room_guid",
                        "in": "path",
                        "required": true,
                        "type": "string"
                    }
                ]
            }
        }
    },
    "definitions": {
        "Tokens": {
            "type": "object",
            "title": "Tokens",
            "properties": {
                "id_token":  {"type":  "string"},
                "access_token":  {"type":  "string"},
                "token_type":  {"type":  "string"},
                "expires_in":  {"type":  "integer"}
            }
        },
        "RefreshToken": {
            "type": "object",
            "title": "Refresh Token",
            "properties": {"refresh_token":  {"type":  "string"}}
        },
        "RoomGuid": {
            "type": "object",
            "title": "Room GUID",
            "properties": {"room_guid":  {"type":  "string"}}
        },
        "RoomSong": {
            "type": "object",
            "title": "Room SOng",
            "properties": {"room_song_guid":  {"type":  "string"}}
        },
        "Room": {
            "type": "object",
            "title": "Room",
            "properties": {"room_code":  {"type":  "string"}}
        },
        "QueueSong": {
            "type": "object",
            "title": "Queue Song",
            "properties": {
                "room_song_guid": {"type":  "string"},
                "song_uri":  {"type":  "string"},
                "song_name":  {"type":  "string"},
                "song_artist":  {"type":  "string"},
                "song_album_url":  {"type":  "string"},
                "is_inactive":  {"type":  "boolean"},
                "insert_time":  {"type":  "string"},
                "is_played":  {"type":  "boolean"},
                "is_removed":  {"type":  "boolean"}
            },
            "example": "{\n\"room_song_guid\": \"f409f9cb-547a-47d6-9b02-fdedc9e3d79a\",\n\"song_uri\": \"spotify:track:3uUuGVFu1V7jTQL60S1r8z\",\n\"song_name\": \"Where Are You Now\",\n\"song_artist\": \"Lost Frequencies, Calum Scott\",\n\"song_album_url\": \"https://i.scdn.co/image/ab67616d0000b2738d7a7f1855b04104ba59c18b\",\n\"is_inactive\": false,\n\"insert_time\": \"2022-04-11 08:59:49\",\n\"is_played\": false,\n\"is_removed\": false\n}"
        },
        "RoomQueue": {
            "type":  "array",
            "items": {
                "type": "QueueSong",
                "example": "{\n\"room_song_guid\": \"f409f9cb-547a-47d6-9b02-fdedc9e3d79a\",\n\"song_uri\": \"spotify:track:3uUuGVFu1V7jTQL60S1r8z\",\n\"song_name\": \"Where Are You Now\",\n\"song_artist\": \"Lost Frequencies, Calum Scott\",\n\"song_album_url\": \"https://i.scdn.co/image/ab67616d0000b2738d7a7f1855b04104ba59c18b\",\n\"is_inactive\": false,\n\"insert_time\": \"2022-04-11 08:59:49\",\n\"is_played\": false,\n\"is_removed\": false\n}"
            }
        },
        "Song": {
            "type": "object",
            "title": "Song",
            "properties": {
                "song_uri":  {"type":  "string"},
                "song_artist":  {"type":  "string"},
                "song_name":  {"type":  "string"},
                "song_album_url":  {"type":  "string"}
            },
            "example": "{\n\"song_uri\": \"spotify:track:1E4xkXgqOCzAjVFnDqhGSx\",\n\"song_artist\": \"Wiz Khalifa\",\n\"song_name\": \"Taylor Gang\",\n\"song_album_url\": \"https://i.scdn.co/image/ab67616d0000b2732a7e92288383175e256a3cb2\"\n}"
        },
        "SearchSong": {
            "type": "array",
            "items": {
                "type": "Song",
                "example": "{\n\"song_uri\": \"spotify:track:1E4xkXgqOCzAjVFnDqhGSx\",\n\"song_artist\": \"Wiz Khalifa\",\n\"song_name\": \"Taylor Gang\",\n\"song_album_url\": \"https://i.scdn.co/image/ab67616d0000b2732a7e92288383175e256a3cb2\"\n}"
            }
        }
    },
    "securityDefinitions": {
        "antwon_user_pool": {
            "in": "header",
            "type": "apiKey",
            "name": "Authorization",
            "x-amazon-apigateway-authtype": "cognito_user_pools",
            "x-amazon-apigateway-authorizer": {
                "type": "cognito_user_pools",
                "providerARNs": [
                    "arn:aws:cognito-idp:eu-west-2:303078101535:userpool/eu-west-2_Y4hA2uEzU"
                ]
            }
        }
    }
}
